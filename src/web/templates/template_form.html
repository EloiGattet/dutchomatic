{% extends "base.html" %}

{% block title %}{% if template %}Modifier{% else %}Créer{% endif %} Template - Dutch-o-matic{% endblock %}

{% block content %}
<div class="page-header">
    <h2>{% if template %}Modifier{% else %}Créer{% endif %} Template</h2>
    <a href="{{ url_for('templates.list_templates') }}" class="btn btn-secondary">Retour</a>
</div>

<form method="POST" class="form" id="template-form" action="{% if template %}{{ url_for('templates.edit_template', template_id=template.id) }}{% else %}{{ url_for('templates.create_template') }}{% endif %}">
    <div class="form-group">
        <label>ID du template *</label>
        <input type="text" name="id" value="{{ template.id if template else '' }}" required {% if template %}readonly{% endif %}>
        <small>Identifiant unique (lettres, chiffres, tirets, underscores)</small>
    </div>
    
    <div class="form-group">
        <label>Nom *</label>
        <input type="text" name="name" value="{{ template.name if template else '' }}" required>
    </div>
    
    <div class="form-row">
        <div class="form-group">
            <label>Type</label>
            <select name="type">
                <option value="exercise" {% if template and template.type == 'exercise' %}selected{% endif %}>Exercice</option>
                <option value="answers" {% if template and template.type == 'answers' %}selected{% endif %}>Réponses</option>
            </select>
        </div>
        <div class="form-group">
            <label>
                <input type="checkbox" name="enabled" {% if not template or template.enabled %}checked{% endif %}>
                Actif
            </label>
        </div>
    </div>
    
    <h3>En-tête</h3>
    <div class="form-group">
        <label>Image (chemin relatif depuis data/)</label>
        <input type="text" name="header_image" value="{{ template.header.image if template and template.header else '' }}" placeholder="logo_print.png">
    </div>
    <div class="form-group">
        <label>Texte personnalisé</label>
        <textarea name="header_custom_text" rows="3">{{ template.header.custom_text if template and template.header else '' }}</textarea>
        <small>Texte à afficher dans l'en-tête (peut contenir des variables comme {title}, {niveau})</small>
    </div>
    
    <h3>Contenu</h3>
    <div class="form-row">
        <div class="form-group">
            <label>
                <input type="checkbox" name="show_title" {% if not template or not template.content or template.content.show_title %}checked{% endif %}>
                Afficher le titre
            </label>
        </div>
        <div class="form-group">
            <label>
                <input type="checkbox" name="show_niveau" {% if not template or not template.content or template.content.show_niveau %}checked{% endif %}>
                Afficher le niveau
            </label>
        </div>
    </div>
    <div class="form-row">
        <div class="form-group">
            <label>
                <input type="checkbox" name="show_prompt" {% if not template or not template.content or template.content.show_prompt %}checked{% endif %}>
                Afficher le prompt
            </label>
        </div>
        <div class="form-group">
            <label>Nombre max d'items</label>
            <input type="number" name="max_items" value="{{ template.content.max_items if template and template.content else '' }}" min="1" placeholder="Tous">
        </div>
    </div>
    <div class="form-group">
        <label>Format des items</label>
        <select name="item_format">
            <option value="numbered" {% if not template or not template.content or template.content.item_format == 'numbered' %}selected{% endif %}>Numérotés (1. 2. 3.)</option>
            <option value="bulleted" {% if template and template.content and template.content.item_format == 'bulleted' %}selected{% endif %}>Puces (- - -)</option>
            <option value="plain" {% if template and template.content and template.content.item_format == 'plain' %}selected{% endif %}>Simple</option>
        </select>
    </div>
    
    <h3>Pied de page</h3>
    <div class="form-group">
        <label>Image (chemin relatif depuis data/)</label>
        <input type="text" name="footer_image" value="{{ template.footer.image if template and template.footer else '' }}" placeholder="footer.png">
    </div>
    <div class="form-group">
        <label>Texte personnalisé</label>
        <textarea name="footer_custom_text" rows="3">{{ template.footer.custom_text if template and template.footer else '' }}</textarea>
    </div>
    
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">{% if template %}Modifier{% else %}Créer{% endif %}</button>
        <a href="{{ url_for('templates.list_templates') }}" class="btn btn-secondary">Annuler</a>
    </div>
</form>

{% endblock %}

